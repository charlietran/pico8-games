pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
objects = {}
player1={
 sprite=1,
 position={x=8,y=112},
 xdir=1,
 ydir=1,
 update=function(this)
  if btn(‚û°Ô∏è) then
   this.xdir=1
   this.position.x+=1
  elseif btn(‚¨ÖÔ∏è) then
   this.xdir=-1
   this.position.x-=1
  end
 end
}
function _init()
 add(objects,player1)
end

function _update()
 if btnp(üÖæÔ∏è,0) then
  --create new bullet,add to
  --objects table
  add(
   objects,
   bulletconstruct(
    player1.position.x,
    player1.position.y,
    player1.xdir))
 end
 for obj in all(objects) do
  obj:update()
 end
end

function _draw()
 cls()
 map(0,0,0,0,16,16)
 foreach(objects,function(obj)
  spr(
   obj.sprite,
   obj.position.x,
   obj.position.y,
   1,1,
   obj.xdir==-1,
   obj.ydir==-1)
 end)
end

function checkwall(obj)
 --detect each corner of hitbox
 local xpos = obj.position.x+
              obj.hitbox.x
 local ypos = obj.position.y+
              obj.hitbox.y
 --top left corner
 local sprite=mget(flr(xpos/8),flr(ypos/8))
 if(fget(sprite,0)) return true
 
 --top right
 sprite=mget(
         flr((xpos+obj.hitbox.w)/8),
         flr(ypos/8))
 if(fget(sprite,0)) return true

 --bottom left
 sprite=mget(
         flr(xpos/8),
         flr((ypos+obj.hitbox.h)/8))
 if(fget(sprite,0)) return true

 --bottom left
 sprite=mget(
         flr((xpos+obj.hitbox.w)/8),
         flr((ypos+obj.hitbox.h)/8))
 if(fget(sprite,0)) return true

 return false
end

function bulletconstruct(x,y,xdir)
 local obj={}
 --array containing x/y pos
 obj.position={x=x,y=y}
 --sprite number for bullet
 obj.sprite=3
 obj.hitbox={x=2,y=4,w=4,h=3}
 obj.xdir=1
 obj.ydir=1
 obj.update = function(this)
  --move bullet to the right
  this.position.x+=xdir*1
  if checkwall(this) then
   del(objects,this)
  end
 end
 
 return obj
end
__gfx__
000000000000000000000000000000000000000022222222dddddddd22222222ddddd22222d2dddd000000000000000000000000000000000000000000000000
00000000bbbbbb0000bbbbbb000000000000000022222222dddddddd22222222dddd2d22222ddddd000000000000000000000000000000000000000000000000
0070070000bb33000033bb00000000000000000022222222dddddddd2d2d2d2dddddd22222d2dddd000000000000000000000000000000000000000000000000
0007700000bb33000033bb00000000000000000022222222ddddddddd2d2d2d2dddd2d22222ddddd000000000000000000000000000000000000000000000000
0007700000bbbb0000bbbb000009900000000000222222222d2d2d2dddddddddddddd22222d2dddd000000000000000000000000000000000000000000000000
0070070000bbddd00dddbb00009aa9000000000022222222d2d2d2d2dddddddddddd2d22222ddddd000000000000000000000000000000000000000000000000
0000000000bb5d5005d5bb0000099000000000002222222222222222ddddddddddddd22222d2dddd000000000000000000000000000000000000000000000000
00000000050005000050005000000000000000002222222222222222dddddddddddd2d22222ddddd000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0907070707070707070707070707070810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0910101010101010101010101010100810101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606060606060606060610101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
